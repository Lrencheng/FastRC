## 硬件架构：
### 主控板
主控电源设计思想：
5V电源：直接来自USB端口，或者来自降压的锂电池电源。注意做好电源隔离
3V3电源：由5V电源经过LDO降压解决，分为两路，一路给stm32F405,传感器及其一些外设端口供电，另一路给SD，LED外设供电

#### 主要器件型号
|器件|型号|
|----|----|
|主控|stm32F405RGT6|
|陀螺仪|ICM-42688-P|
|气压计|SPL06|
|磁力计|LIS3MDLTR|
#### 开关设计：
BUTTON1:切换多旋翼/火箭模式
BOOT0:
#### 接口资源
`六路UART串口`
|  串口  |  作用  |
|--|--|
|UART1|接收机：支持ELRS和SBUS|
|UART2|GPS接口：支持串口通信和IIC的GPS|
|UART3|空闲|
|UART4|空闲|
|UART5|空闲|
|UART6|空闲|

`6路GPIO`
|  GPIO  |  作用  |推荐模式|
|--|--|--|
|GPIO1|点火端口|GPIO_ouput|
|GPIO2|安全端口|GPIO_input|
|GPIO3|空闲|---|
|GPIO4|空闲|---|
|GPIO5|空闲|---|
|GPIO6|空闲|---|

`9路PWM`
| PWM | 作用 |
|---|---|
|TIM1_CH1/GPIO7|蜂鸣器控制|
|TIM1_CH2|空闲|
|TIM1_CH3|空闲|
|TIM2_CH1|空闲|
|TIM2_CH2|空闲|
|TIM3_CH1|电机/舵机|
|TIM3_CH2|电机/舵机|
|TIM3_CH3|电机/舵机|
|TIM3_CH4|电机/舵机|

其他:
|Interface|作用|
|--|--|
|拓展IIC|空闲|
|typec|提供电源，传输数据|

### 电源板
#### 设计思想
11.7V->5V在电源板上完成
5v->3.3v只需要在需要的期间上引出3V3给LDO的OUT就行
电源板还需要完成：
9路舵机供电
两个点火端口
### 信号板
放置GPS和接收机

## 设计目标
1. 正常计算姿态
2. 存储数据
3. 控制点火，开伞和舵机
### 拓展设计目标
1. 数据回传
2. 上位机通信



### 电路电子设计笔记
#### 晶振
公式：$CL(\text{负载电容})=\frac{Cd\times Cg}{Cd+Cg}$
> Cd和Cg位连接在晶振旁边的电容

![](./assets/晶振旁路电容.png)

#### IIC引脚上拉

IIC引脚是开漏输出，需要连接上拉电阻，通常是4.7K$\Omega$

#### IIC
飞控分配了两路总线的IIC,一路是气压计，另外一路是GPS

#### todo
1. GPS线序检查
2. 去掉si24r1模块，替换为USB
   - 使用Typec后，TIM1的CH4通道被占用，想要获得高质量的PWM，需要从TIM8中获取
   - 目前设定的PWM端口：TIM1：1~3,TIM2：1~2,TIM3：1~4

3. 增加黑匣子
4. 数传通信还没有想好具体的方案

##### todo
1. 电源有待优化，目前只能提供一个5V4A恐怕不够全负载的情况
2. 具体需要几个LDO提供3V3缺乏详尽的估算
|主要器件|最大电流/mA|
| F405 |150|
|LED|30|
|磁力计|0.27|
|陀螺仪|0.88|
|气压计|<1|
|SD卡|300|
|拓展IOX6|120|
##### todo
1. 滤波电容的设计是滤波5V电压还是3V3电压；放置的位置有什么要求
2. 传感器应该共用一个LDO吗